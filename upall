#!/bin/bash

set -e

if [[ ! "$OSTYPE" == darwin* ]]; then
  return
fi

echo '# Updating dotfiles and bin'
cd $HOME/bin; git pull; cd $HOME/src/dotfiles; git pull

echo '# Updating rubygems'
gem update --system
gem update
echo '####################'

echo '# Updating Homebrew'
brew update
brew upgrade --all
echo '####################'

echo '# Updating ZSH plugins'
cd "$HOME"/src/dotfiles
./update
echo '####################'

echo '# Updating neovim'
brew reinstall --HEAD neovim

fix_open_with_duplicates

echo '# Updating repos on remote'
ssh pair 'cd $HOME/bin; git pull; cd $HOME/src/dotfiles; git pull'
ssh pair 'gem update --system'
ssh pair 'gem update'
